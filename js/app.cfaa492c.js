(function(t){function e(e){for(var n,s,o=e[0],l=e[1],c=e[2],h=0,f=[];h<o.length;h++)s=o[h],i[s]&&f.push(i[s][0]),i[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(f.length)f.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},i={app:0},r=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/plotly-image-viewer/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("c21b"),i=a.n(n);i.a},"06b5":function(t,e,a){"use strict";var n=a("73a1"),i=a.n(n);i.a},"199c":function(t,e,a){"use strict";(function(t){a("ac6a"),a("7f7f"),a("28a5"),a("6b54"),a("96cf");var n=a("3040"),i=(a("a481"),a("386d"),a("cadf"),a("551c"),a("097d"),a("674b")),r=a("3c4d"),s=a("7fab"),o=a("755b"),l=a.n(o),c=a("d051"),u=a.n(c),h=a("9cb3"),f=a("ffe7"),d=a.n(f),p=a("bc3a"),m=a("bd7e"),g=a("eabd"),v=a("6724");e["a"]={data:function(){return{title:"plotly.js image viewer",fromGithub:!1,versions:["local","master","1.41.2","1.31.0","1.2.0"],baseUrl:"http://localhost:3000",orcaUrl:"http://localhost:9091",mock:null,mockPayload:null,numDiffPixels:0,fuse:null,fuseOptions:{},AutocompleteItem:h["a"],AllMocks:[],results:[],mapboxAccessToken:"pk.eyJ1IjoiZXRwaW5hcmQiLCJhIjoiY2luMHIzdHE0MGFxNXVubTRxczZ2YmUxaCJ9.hwWZful0U2CQxit4ItNsiQ",errorMsg:!1,loading:!1}},beforeRouteUpdate:function(t,e,a){this.fetchMock(t.params.id),a()},computed:{rawGithubBaseUrl:function(){return"https://raw.githubusercontent.com/plotly/plotly.js/"+this.fromGithub},image:function(){return this.mock?"".concat(this.baseUrl,"/build/test_images/").concat(this.mock,".png"):"https://tamarack-prismic.imgix.net/plotly/89baddfcf14ab9543598ae83b84ae6db0d6e1c2f_00--58_105x.jpg?w=800&sat=0"},baseline:function(){return this.mock?"".concat(this.fromGithub?this.rawGithubBaseUrl:this.baseUrl,"/test/image/baselines/").concat(this.mock,".png"):"https://tamarack-prismic.imgix.net/plotly/89baddfcf14ab9543598ae83b84ae6db0d6e1c2f_00--58_105x.jpg?w=800&sat=-100"},json_url:function(){if(this.mock)return"".concat(this.fromGithub?this.rawGithubBaseUrl:this.baseUrl,"/test/image/mocks/").concat(this.mock,".json")}},methods:{initFuse:function(t){this.fuse=new d.a(t,this.fuseOptions)},updateResults:function(t){var e=this;this.results=this.fuse.search(t).map(function(t){return e.AllMocks[t]})},navigate:function(t){this.$router.replace({params:{id:t}})},fetchMock:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:this.errorMsg=!1,this.mockPayload=null,a=this,a.loading=!0,n=m(a.$refs.image),i=m(a.$refs.baseline),n.on("fail",function(){a.errorMsg="Cannot load image ".concat(a.$refs.image.src),a.$refs.image.src="favicon.ico"}),i.on("fail",function(){a.errorMsg="Cannot load image ".concat(a.$refs.baseline.src),a.$refs.baseline.src="favicon.ico",a.loading=!1}),i.on("done",function(){var t=a.$refs.baseline.width,e=a.$refs.baseline.height;console.log("Fetching ".concat(a.json_url)),p.get(a.json_url).then(function(t){return a.mockPayload=t.data}).catch(function(t){return a.mockPayload=null,a.loading=!1,a.errorMsg=t}).then(function(n){n&&(a.$refs.graph.style.width=t+"px",a.$refs.graph.style.height=e+"px",a.imgDiff(),a.plotlyRender())}).finally(function(){return a.loading=!1})}),a.mock=e;case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),plotlyRender:function(){if(this.mockPayload){var t=JSON.parse(JSON.stringify(this.mockPayload));return t.layout?(t.layout.width&&delete t.layout.width,t.layout.height&&delete t.layout.height):t.layout={},t.layout.autosize=!0,t.config={mapboxAccessToken:this.mapboxAccessToken},Plotly.newPlot("graph",t)}},orcaRender:function(){var e=this;if(this.mockPayload){var a=JSON.parse(JSON.stringify(this.mockPayload));a.layout||(a.layout={}),a.layout.width=this.$refs.baseline.width,a.layout.height=this.$refs.baseline.height;var n=this;n.loading=!0,p({method:"post",url:n.orcaUrl,data:a,responseType:"arraybuffer"}).then(function(e){return new t(e.data,"binary").toString("base64")}).then(function(t){return e.$refs.image.src="data:image/png;base64,"+t}).then(n.imgDiff).finally(function(){return n.loading=!1})}},imgDiff:function(){var t=this.$refs.baseline.width,e=this.$refs.baseline.height,a=this.convertImageToCanvas(this.$refs.baseline).getContext("2d"),n=this.convertImageToCanvas(this.$refs.image).getContext("2d"),i=this.$refs.diff.getContext("2d"),r=a.getImageData(0,0,t,e),s=n.getImageData(0,0,t,e),o=i.createImageData(t,e);this.$refs.diff.width=t,this.$refs.diff.height=e,this.numDiffPixels=g(r.data,s.data,o.data,t,e,{threshold:.1}),i.putImageData(o,0,0)},convertImageToCanvas:function(t){var e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},fetAllMocksGithub:function(){var t="https://api.github.com/repos/plotly/plotly.js/contents/test/image/mocks",e=this;p.get(t).then(function(t){var e=t.data.map(function(t){return t.name.split("/").splice(-1)[0].replace(".json","")});return e}).then(function(t){e.initFuse(t),e.AllMocks=t})},fetchAllMocks:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e="".concat(this.baseUrl,"/test/image/mocks/"),a=this,p.get(e).then(function(t){var e=new v.DefaultHandler(function(t,e){t&&(a.errorMsg=t)}),n=new v.Parser(e);n.parseComplete(t.data);var i=e.dom[2].children[3].children[3].children,r=i.filter(function(t,e){return e%2===0}).map(function(t){return t.children[3].children[0].attribs.href.split("/").splice(-1)[0].replace(".json","")});return r}).then(function(t){a.initFuse(t),a.AllMocks=t});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},created:function(){this.fromGithub?this.fetAllMocksGithub():this.fetchAllMocks()},mounted:function(){[this.$refs.baseline,this.$refs.image].forEach(function(t){return t.crossOrigin="Anonymous"}),this.fetchMock(this.$route.params.id)},components:{Comparify:i["a"],Opacity:r["a"],JsonTree:s["a"],Autocomplete:u.a,Loading:l.a}}}).call(this,a("b639").Buffer)},"3c4d":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compare-wrapper"},[a("div",{staticClass:"compare"},[a("div",{staticClass:"compare__content",style:{opacity:t.opacity/100}},[t._t("first")],2),a("div",{staticClass:"handle-wrap",style:{left:"calc("+t.opacity+"% - var(--handle-line-width) / 2"}},[a("div",{staticClass:"handle"},[a("svg",{staticClass:"handle__arrow handle__arrow--l feather feather-chevron-left",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[a("polyline",{attrs:{points:"15 18 9 12 15 6"}})]),a("svg",{staticClass:"handle__arrow handle__arrow--r feather feather-chevron-right",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[a("polyline",{attrs:{points:"9 18 15 12 9 6"}})])]),a("span",{staticClass:"handle-line"})]),a("div",{staticClass:"compare-overlay"},[a("div",{staticClass:"compare-overlay__content",style:{opacity:1-t.opacity/100}},[t._t("second")],2)])]),a("input",{staticClass:"compare__range",attrs:{type:"range",min:"0",max:"100",step:t.step,tabindex:"-1"},domProps:{value:t.opacity},on:{input:t.handleInput}})])},i=[],r={props:{value:{default:50},step:{default:".1"}},data:function(){return{opacity:1}},mounted:function(){this.opacity=this.value},methods:{handleInput:function(t){this.opacity=t.target.value,this.$emit("input",t.target.value)}}},s=r,o=(a("06b5"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"0c1c3f2c",null);l.options.__file="Opacity.vue";e["a"]=l.exports},"3e2e":function(t,e,a){"use strict";var n=a("a700"),i=a.n(n);i.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("097d");var n=a("ba4c"),i=a.n(n),r=a("8c4f"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("loading",{attrs:{show:t.loading}}),t._m(0),a("div",{staticClass:"controls"},[a("autocomplete",{attrs:{"min-len":0,wait:10,"component-item":t.AutocompleteItem,items:t.results,"input-attrs":{placeholder:"search mocks"}},on:{submit:function(e){t.navigate(this.value)},"item-selected":t.navigate,"update-items":t.updateResults}}),a("select",t._l(t.versions,function(e){return a("option",{key:e,domProps:{value:e}},[t._v(t._s(e))])})),a("input",{staticStyle:{width:"25px",height:"25px"},attrs:{type:"image",src:"https://raw.githubusercontent.com/plotly/orca/master/orca_logo.png"},on:{click:t.orcaRender}})],1),t.errorMsg?a("div",{staticClass:"error"},[a("h3",[t._v(t._s(t.errorMsg))])]):t._e(),a("div",{staticClass:"preview"},[a("div",[a("h3",[t._v("Comparison slider")]),a("comparify",{attrs:{value:"50"}},[a("img",{ref:"baseline",attrs:{slot:"first",src:t.baseline},slot:"first"}),a("img",{ref:"image",attrs:{slot:"second",src:t.image},slot:"second"})])],1),t.mock?a("div",[a("h3",[t._v("Diff ("+t._s(t.numDiffPixels)+" different pixels)")]),a("canvas",{ref:"diff"})]):t._e(),t._e(),t.mockPayload?a("div",[a("h3",[t._v("Live")]),a("comparify",{attrs:{value:"50"}},[a("img",{attrs:{slot:"first",src:t.baseline},slot:"first"}),a("div",{ref:"graph",attrs:{slot:"second",id:"graph"},slot:"second"})])],1):t._e(),t._e()]),a("footer",[t._v("\r\n      Serving assets from: "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.baseUrl,expression:"baseUrl"}],attrs:{type:"text"},domProps:{value:t.baseUrl},on:{input:function(e){e.target.composing||(t.baseUrl=e.target.value)}}})])],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",[a("a",{attrs:{href:"https://plot.ly"}},[a("img",{staticClass:"plotly-logo",attrs:{src:"https://tamarack-prismic.imgix.net/plotly/eb464d43-4ab4-427e-b617-482b62ba6c69_plotly-logo-white.png?w=100&auto=format"}})])])}],l=a("199c"),c=l["a"],u=(a("034f"),a("2877")),h=Object(u["a"])(c,s,o,!1,null,null,null);h.options.__file="App.vue";var f=h.exports;i.a.use(r["a"]),i.a.config.productionTip=!1;var d=[{path:"/:id?",component:f}],p=new r["a"]({routes:d});new i.a({router:p}).$mount("#app")},"674b":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"compare-wrapper"},[a("div",{staticClass:"compare"},[a("div",{staticClass:"compare__content",style:{width:t.width}},[t._t("first")],2),a("div",{staticClass:"handle-wrap",style:{left:"calc("+t.compareWidth+"% - var(--handle-line-width) / 2"}},[a("div",{staticClass:"handle"},[a("svg",{staticClass:"handle__arrow handle__arrow--l feather feather-chevron-left",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[a("polyline",{attrs:{points:"15 18 9 12 15 6"}})]),a("svg",{staticClass:"handle__arrow handle__arrow--r feather feather-chevron-right",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}},[a("polyline",{attrs:{points:"9 18 15 12 9 6"}})])]),a("span",{staticClass:"handle-line"})]),a("div",{staticClass:"compare-overlay ",style:{width:"calc("+t.compareWidth+"%)"}},[a("div",{staticClass:"compare-overlay__content",style:{width:t.width}},[t._t("second")],2)])]),a("input",{staticClass:"compare__range",attrs:{type:"range",min:"0",max:"100",step:t.step,tabindex:"-1"},domProps:{value:t.compareWidth},on:{input:t.handleInput}})])},i=[],r=(a("cadf"),a("551c"),a("097d"),{props:{value:{default:50},step:{default:".1"}},data:function(){return{width:null,compareWidth:this.value}},watch:{value:function(){this.compareWidth=this.value}},mounted:function(){this.width=this.getContainerWidth(),window.addEventListener("resize",this.handleResize)},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)},methods:{handleInput:function(t){this.compareWidth=t.target.value,this.$emit("input",t.target.value)},handleResize:function(){var t=this.getContainerWidth();t!==this.width&&(this.width=t)},getContainerWidth:function(){return window.getComputedStyle(this.$el,null).getPropertyValue("width")}}}),s=r,o=(a("3e2e"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,null,null);l.options.__file="Comparify.vue";e["a"]=l.exports},"73a1":function(t,e,a){},"9cb3":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",[t._v("\n"+t._s(t.item)+"\n")])},i=[],r={props:{item:{required:!0}}},s=r,o=a("2877"),l=Object(o["a"])(s,n,i,!1,null,null,null);l.options.__file="AutocompleteItem.vue";e["a"]=l.exports},a700:function(t,e,a){},c21b:function(t,e,a){}});
//# sourceMappingURL=app.cfaa492c.js.map